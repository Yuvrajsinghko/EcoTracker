<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login Carbondash</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css')}}"
    />

    <link
      href="https://cdn.boxicons.com/fonts/basic/boxicons.min.css"
      rel="stylesheet"
    />
  </head>

  <body>
    <div class="wrapper">
      <form action="/submit" method="POST">
        <h1>Login</h1>

        {% with messages = get_flashed_messages(with_categories=true) %} {% if
        messages %} {% for category, message in messages %}
        <div class="flash-message flash-{{ category }}">{{ message }}</div>
        {% endfor %} {% endif %} {% endwith %}

        <div class="input-box">
          <input
            type="text"
            name="username"
            placeholder="Username"
            required
            autocomplete="username"
            minlength="8"
            maxlength="10"
          />
          <i class="bxr bx-user"></i>
        </div>

        <div class="input-box">
          <input
            type="password"
            name="password"
            placeholder="Password"
            required
            autocomplete="new-password"
            minlength="8"
            maxlength="12"
          />
          <i class="bx bx-lock"></i>
        </div>

        <div class="remember-forgot">
          <label><input type="checkbox" />Remember Me</label>
          <a href="{{ url_for('forgot_password') }}">Forgot Password?</a>
        </div>

        <button type="submit" value="login" class="btn">Login</button>

        <div class="register-link">
          <p>
            Don't have an account ?
            <a href="{{ url_for('signup')}}">Register</a>
          </p>
        </div>
      </form>
    </div>

    <script>
      // Simple script to clear password if browser auto-fills it
      window.onload = function () {
        document.querySelector('input[name="password"]').value = "";
      };

      // Form validation feedback for login form
      document.querySelector('form').addEventListener('submit', function(e) {
          const form = this;
          if (!form.checkValidity()) {
              e.preventDefault();
              e.stopPropagation();

              // Focus on first invalid field
              const firstInvalid = form.querySelector(':invalid');
              if (firstInvalid) {
                  firstInvalid.focus();
              }
          }
          form.classList.add('was-validated');
      });

      // Real-time validation styling for all inputs
      document.querySelectorAll('input').forEach(input => {
          input.addEventListener('input', function() {
              if (this.checkValidity()) {
                  this.classList.remove('is-invalid');
                  this.classList.add('is-valid');
              } else {
                  this.classList.remove('is-valid');
                  this.classList.add('is-invalid');
              }
          });
      });
    </script>
  </body>
</html>
